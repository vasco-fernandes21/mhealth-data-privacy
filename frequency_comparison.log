======================================================================
WESAD FREQUENCY COMPARISON EXPERIMENT
======================================================================

4 Hz (low compute, potential information loss)

======================================================================
TRAINING WITH 4hz
======================================================================

Loading data from: /Users/vasco/Desktop/Mestrado/SIDM/mhealth-data-privacy/data/processed/wesad_binary
Loading processed WESAD data from /Users/vasco/Desktop/Mestrado/SIDM/mhealth-data-privacy/data/processed/wesad_binary...
Loaded:
  Train: (715, 14, 240)
  Val: (237, 14, 240)
  Test: (237, 14, 240)
  Classes: ['non-stress', 'stress']
  Channels: 14

Data info:
  Shape: (715, 14, 240)
  Memory: 18.33 MB
  Classes: ['non-stress', 'stress']

Model summary:
Model: "CNN_LSTM_240"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ conv1d (Conv1D)                 │ (None, 14, 64)         │        76,864 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ batch_normalization             │ (None, 14, 64)         │           256 │
│ (BatchNormalization)            │                        │               │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling1d (MaxPooling1D)    │ (None, 7, 64)          │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 7, 64)          │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ conv1d_1 (Conv1D)               │ (None, 7, 128)         │        41,088 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ batch_normalization_1           │ (None, 7, 128)         │           512 │
│ (BatchNormalization)            │                        │               │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling1d_1 (MaxPooling1D)  │ (None, 3, 128)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 3, 128)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm (LSTM)                     │ (None, 64)             │        49,408 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_2 (Dropout)             │ (None, 64)             │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 32)             │         2,080 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_3 (Dropout)             │ (None, 32)             │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_1 (Dense)                 │ (None, 2)              │            66 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 170,274 (665.13 KB)
 Trainable params: 169,890 (663.63 KB)
 Non-trainable params: 384 (1.50 KB)
Total parameters: 170,274

======================================================================
TRAINING
======================================================================
Epoch 1/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m51s[0m 2s/step - accuracy: 0.4062 - loss: 0.7737[1m 3/23[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 33ms/step - accuracy: 0.4132 - loss: 0.7559[1m 9/23[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 15ms/step - accuracy: 0.4461 - loss: 0.7270[1m16/23[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 21ms/step - accuracy: 0.4618 - loss: 0.7121[1m17/23[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 23ms/step - accuracy: 0.4636 - loss: 0.7108[1m22/23[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 20ms/step - accuracy: 0.4719 - loss: 0.7055[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m3s[0m 33ms/step - accuracy: 0.5035 - loss: 0.6865 - val_accuracy: 0.6034 - val_loss: 0.7366 - learning_rate: 0.0010
Epoch 2/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 18ms/step - accuracy: 0.7188 - loss: 0.5995[1m10/23[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - accuracy: 0.6793 - loss: 0.6368 [1m20/23[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 6ms/step - accuracy: 0.6751 - loss: 0.6255[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 9ms/step - accuracy: 0.6741 - loss: 0.5982 - val_accuracy: 0.6287 - val_loss: 0.8042 - learning_rate: 0.0010
Epoch 3/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 21ms/step - accuracy: 0.6562 - loss: 0.5715[1m 4/23[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m0s[0m 19ms/step - accuracy: 0.7012 - loss: 0.5474[1m10/23[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 12ms/step - accuracy: 0.7078 - loss: 0.5406[1m18/23[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 10ms/step - accuracy: 0.7233 - loss: 0.5325[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 61ms/step - accuracy: 0.7608 - loss: 0.5030 - val_accuracy: 0.6498 - val_loss: 1.0035 - learning_rate: 0.0010
Epoch 4/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m2s[0m 101ms/step - accuracy: 0.9375 - loss: 0.2868[1m 3/23[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m2s[0m 122ms/step - accuracy: 0.8941 - loss: 0.3310[1m 6/23[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m1s[0m 59ms/step - accuracy: 0.8553 - loss: 0.3472 [1m10/23[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 39ms/step - accuracy: 0.8414 - loss: 0.3577[1m13/23[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 34ms/step - accuracy: 0.8364 - loss: 0.3681[1m16/23[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 31ms/step - accuracy: 0.8327 - loss: 0.3780[1m21/23[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 26ms/step - accuracy: 0.8297 - loss: 0.3860[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 27ms/step - accuracy: 0.8289 - loss: 0.3881[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 33ms/step - accuracy: 0.8210 - loss: 0.4081 - val_accuracy: 0.6456 - val_loss: 1.1230 - learning_rate: 0.0010
Epoch 5/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 20ms/step - accuracy: 0.9062 - loss: 0.2848[1m 9/23[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 7ms/step - accuracy: 0.8829 - loss: 0.3005 [1m17/23[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 7ms/step - accuracy: 0.8718 - loss: 0.3146[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 9ms/step - accuracy: 0.8629 - loss: 0.3309 - val_accuracy: 0.6624 - val_loss: 1.0641 - learning_rate: 0.0010
Epoch 6/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 19ms/step - accuracy: 0.8438 - loss: 0.3328[1m10/23[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - accuracy: 0.8887 - loss: 0.2612 [1m18/23[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 6ms/step - accuracy: 0.9030 - loss: 0.2431[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 9ms/step - accuracy: 0.9231 - loss: 0.2170 - val_accuracy: 0.6034 - val_loss: 1.1520 - learning_rate: 0.0010
Epoch 7/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 25ms/step - accuracy: 0.8125 - loss: 0.3127[1m11/23[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 5ms/step - accuracy: 0.9073 - loss: 0.2087 [1m19/23[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 6ms/step - accuracy: 0.9202 - loss: 0.2009[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 8ms/step - accuracy: 0.9371 - loss: 0.1804 - val_accuracy: 0.6540 - val_loss: 1.1758 - learning_rate: 0.0010
Epoch 8/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 20ms/step - accuracy: 0.9688 - loss: 0.1515[1m10/23[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - accuracy: 0.9606 - loss: 0.1313 [1m19/23[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 6ms/step - accuracy: 0.9565 - loss: 0.1333[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 8ms/step - accuracy: 0.9524 - loss: 0.1392 - val_accuracy: 0.7089 - val_loss: 0.9946 - learning_rate: 0.0010
Epoch 9/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 18ms/step - accuracy: 0.9688 - loss: 0.0581[1m11/23[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 5ms/step - accuracy: 0.9526 - loss: 0.1018 [1m19/23[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 6ms/step - accuracy: 0.9528 - loss: 0.1118
Epoch 9: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.
[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 9ms/step - accuracy: 0.9580 - loss: 0.1123 - val_accuracy: 0.6287 - val_loss: 1.9460 - learning_rate: 0.0010
Epoch 10/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 21ms/step - accuracy: 0.9688 - loss: 0.0689[1m 8/23[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 7ms/step - accuracy: 0.9767 - loss: 0.0692 [1m10/23[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 11ms/step - accuracy: 0.9771 - loss: 0.0691[1m12/23[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 15ms/step - accuracy: 0.9768 - loss: 0.0718[1m14/23[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 16ms/step - accuracy: 0.9762 - loss: 0.0738[1m17/23[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 17ms/step - accuracy: 0.9752 - loss: 0.0754[1m20/23[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 18ms/step - accuracy: 0.9750 - loss: 0.0761[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 20ms/step - accuracy: 0.9748 - loss: 0.0753 - val_accuracy: 0.6540 - val_loss: 1.3915 - learning_rate: 5.0000e-04
Epoch 11/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 25ms/step - accuracy: 1.0000 - loss: 0.0422[1m 7/23[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - accuracy: 0.9922 - loss: 0.0489 [1m15/23[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 8ms/step - accuracy: 0.9907 - loss: 0.0535[1m21/23[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 9ms/step - accuracy: 0.9895 - loss: 0.0550[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 12ms/step - accuracy: 0.9860 - loss: 0.0571 - val_accuracy: 0.6624 - val_loss: 1.9351 - learning_rate: 5.0000e-04
Epoch 12/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 19ms/step - accuracy: 0.9688 - loss: 0.0592[1m 6/23[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 10ms/step - accuracy: 0.9750 - loss: 0.0663[1m14/23[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 8ms/step - accuracy: 0.9792 - loss: 0.0571 [1m19/23[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 9ms/step - accuracy: 0.9793 - loss: 0.0558[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 14ms/step - accuracy: 0.9790 - loss: 0.0524 - val_accuracy: 0.6582 - val_loss: 2.0445 - learning_rate: 5.0000e-04
Epoch 13/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 30ms/step - accuracy: 0.9375 - loss: 0.1054[1m 6/23[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 11ms/step - accuracy: 0.9469 - loss: 0.1090[1m10/23[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 12ms/step - accuracy: 0.9576 - loss: 0.0901[1m19/23[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 9ms/step - accuracy: 0.9683 - loss: 0.0730 [1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 10ms/step - accuracy: 0.9832 - loss: 0.0488 - val_accuracy: 0.6582 - val_loss: 1.9199 - learning_rate: 5.0000e-04
Epoch 14/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 18ms/step - accuracy: 1.0000 - loss: 0.0217[1m11/23[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 5ms/step - accuracy: 0.9926 - loss: 0.0284 [1m22/23[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 5ms/step - accuracy: 0.9930 - loss: 0.0292[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.9916 - loss: 0.0325 - val_accuracy: 0.6540 - val_loss: 1.9841 - learning_rate: 5.0000e-04
Epoch 15/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 16ms/step - accuracy: 1.0000 - loss: 0.0026[1m11/23[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 5ms/step - accuracy: 0.9929 - loss: 0.0319 [1m22/23[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 5ms/step - accuracy: 0.9911 - loss: 0.0361[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.9902 - loss: 0.0361 - val_accuracy: 0.6624 - val_loss: 2.1039 - learning_rate: 5.0000e-04
Epoch 16/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 16ms/step - accuracy: 1.0000 - loss: 0.0140[1m 9/23[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 7ms/step - accuracy: 0.9981 - loss: 0.0180 [1m16/23[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 7ms/step - accuracy: 0.9952 - loss: 0.0200[1m22/23[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 8ms/step - accuracy: 0.9939 - loss: 0.0220[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 10ms/step - accuracy: 0.9902 - loss: 0.0333 - val_accuracy: 0.6498 - val_loss: 2.0081 - learning_rate: 5.0000e-04
Epoch 17/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 21ms/step - accuracy: 1.0000 - loss: 0.0108[1m10/23[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - accuracy: 0.9827 - loss: 0.0338 [1m20/23[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 6ms/step - accuracy: 0.9871 - loss: 0.0327
Epoch 17: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.
[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.9944 - loss: 0.0288 - val_accuracy: 0.6456 - val_loss: 2.1701 - learning_rate: 5.0000e-04
Epoch 18/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 16ms/step - accuracy: 1.0000 - loss: 0.0094[1m11/23[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 5ms/step - accuracy: 0.9975 - loss: 0.0185 [1m21/23[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 5ms/step - accuracy: 0.9951 - loss: 0.0215[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.9916 - loss: 0.0313 - val_accuracy: 0.6540 - val_loss: 2.1271 - learning_rate: 2.5000e-04
Epoch 19/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 18ms/step - accuracy: 0.9688 - loss: 0.0408[1m11/23[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 5ms/step - accuracy: 0.9914 - loss: 0.0224 [1m21/23[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 5ms/step - accuracy: 0.9930 - loss: 0.0218[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 8ms/step - accuracy: 0.9930 - loss: 0.0239 - val_accuracy: 0.6540 - val_loss: 2.0015 - learning_rate: 2.5000e-04
Epoch 20/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 31ms/step - accuracy: 1.0000 - loss: 0.0076[1m 9/23[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 7ms/step - accuracy: 0.9992 - loss: 0.0113 [1m18/23[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 6ms/step - accuracy: 0.9984 - loss: 0.0129[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 8ms/step - accuracy: 0.9972 - loss: 0.0130 - val_accuracy: 0.6498 - val_loss: 2.0274 - learning_rate: 2.5000e-04
Epoch 21/100
[1m 1/23[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 16ms/step - accuracy: 1.0000 - loss: 0.0079[1m11/23[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 5ms/step - accuracy: 0.9947 - loss: 0.0152 [1m21/23[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 5ms/step - accuracy: 0.9935 - loss: 0.0204[1m23/23[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 8ms/step - accuracy: 0.9930 - loss: 0.0304 - val_accuracy: 0.6456 - val_loss: 1.8994 - learning_rate: 2.5000e-04
Epoch 21: early stopping
Restoring model weights from the end of the best epoch: 1.

======================================================================
EVALUATION
======================================================================

Overall Metrics:
  Accuracy:  0.7300
  Precision: 0.8049
  Recall:    0.7300
  F1-Score:  0.7403

Per-Class:
  non-stress:
    Precision: 0.9237
    Recall:    0.6646
    F1:        0.7730
  stress:
    Precision: 0.5378
    Recall:    0.8767
    F1:        0.6667

Confusion Matrix:
[[109  55]
 [  9  64]]

Training time: 9.48s (0.16 min)
Epochs trained: 21

✓ Results saved to: /Users/vasco/Desktop/Mestrado/SIDM/mhealth-data-privacy/results/wesad/frequency_comparison/results_4hz.json

32 Hz (preserves ECG/BVP details)

======================================================================
TRAINING WITH 32hz
======================================================================

Loading data from: /Users/vasco/Desktop/Mestrado/SIDM/mhealth-data-privacy/data/processed/wesad_binary_32hz
Loading processed WESAD data from /Users/vasco/Desktop/Mestrado/SIDM/mhealth-data-privacy/data/processed/wesad_binary_32hz...
Loaded:
  Train: (715, 14, 1920)
  Val: (237, 14, 1920)
  Test: (237, 14, 1920)
  Classes: ['non-stress', 'stress']
  Channels: 14

Data info:
  Shape: (715, 14, 1920)
  Memory: 146.63 MB
  Classes: ['non-stress', 'stress']

Model summary:
Model: "CNN_LSTM_1920"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ conv1d_2 (Conv1D)               │ (None, 14, 64)         │       614,464 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ batch_normalization_2           │ (None, 14, 64)         │           256 │
│ (BatchNormalization)            │                        │               │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling1d_2 (MaxPooling1D)  │ (None, 3, 64)          │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_4 (Dropout)             │ (None, 3, 64)          │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ conv1d_3 (Conv1D)               │ (None, 3, 128)         │        41,088 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ batch_normalization_3           │ (None, 3, 128)         │           512 │
│ (BatchNormalization)            │                        │               │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling1d_3 (MaxPooling1D)  │ (None, 0, 128)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_5 (Dropout)             │ (None, 0, 128)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ conv1d_4 (Conv1D)               │ (None, 0, 128)         │        49,280 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ batch_normalization_4           │ (None, 0, 128)         │           512 │
│ (BatchNormalization)            │                        │               │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ max_pooling1d_4 (MaxPooling1D)  │ (None, 0, 128)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_6 (Dropout)             │ (None, 0, 128)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 64)             │        49,408 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_7 (Dropout)             │ (None, 64)             │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_2 (Dense)                 │ (None, 32)             │         2,080 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_8 (Dropout)             │ (None, 32)             │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense_3 (Dense)                 │ (None, 2)              │            66 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 757,666 (2.89 MB)
 Trainable params: 757,026 (2.89 MB)
 Non-trainable params: 640 (2.50 KB)
Total parameters: 757,666

======================================================================
TRAINING
======================================================================
Epoch 1/100
Traceback (most recent call last):
  File "/Users/vasco/Desktop/Mestrado/SIDM/mhealth-data-privacy/src/train/wesad/compare_frequencies.py", line 296, in <module>
    main()
  File "/Users/vasco/Desktop/Mestrado/SIDM/mhealth-data-privacy/src/train/wesad/compare_frequencies.py", line 245, in main
    results = train_and_evaluate(config['data_dir'], config['freq_label'], output_dir)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/vasco/Desktop/Mestrado/SIDM/mhealth-data-privacy/src/train/wesad/compare_frequencies.py", line 131, in train_and_evaluate
    history = model.fit(
              ^^^^^^^^^^
  File "/Users/vasco/Desktop/Mestrado/SIDM/mhealth-data-privacy/venv/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/Users/vasco/Desktop/Mestrado/SIDM/mhealth-data-privacy/venv/lib/python3.12/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
        ^^^^^^^^^^^
ValueError: Exception encountered when calling MaxPooling1D.call().

[1mNegative dimension size caused by subtracting 4 from 3 for '{{node CNN_LSTM_1920_1/max_pooling1d_3_1/MaxPool1d}} = MaxPool[T=DT_FLOAT, data_format="NHWC", explicit_paddings=[], ksize=[1, 1, 4, 1], padding="VALID", strides=[1, 1, 4, 1]](CNN_LSTM_1920_1/max_pooling1d_3_1/MaxPool1d/ExpandDims)' with input shapes: [?,1,3,128].[0m

Arguments received by MaxPooling1D.call():
  • inputs=tf.Tensor(shape=(None, 3, 128), dtype=float32)
