{
  "dataset": "Sleep-EDF",
  "version": "1.0_corrected",
  "date": "2025-10-31",
  "description": "Configuração correta baseada em análise real do dataset Sleep-EDF",
  "source": "Análise de 5 sujeitos (ST7011, ST7012, ST7021, ST7022, ST7041)",
  
  "file_format": {
    "type": "EDF (European Data Format)",
    "extension": ".edf",
    "files_per_subject": 2,
    "psg_file": "*-PSG.edf (polysomnography signals)",
    "hypno_file": "*-Hypnogram.edf (sleep stage labels)"
  },
  
  "channels": {
    "EEG_Fpz_Cz": {
      "description": "EEG frontal-parietal (Fpz-Cz)",
      "unit": "μV",
      "sampling_rate": 100,
      "mean": -59.70,
      "std": 346.43,
      "min": -2883.17,
      "max": 2986.08,
      "typical_range_p1": -2353.23,
      "typical_range_p99": 121.04,
      "median": -0.18,
      "physical_range": [-3000, 3000],
      "digital_range": [-8192, 8191],
      "filter": {
        "type": "Butterworth bandpass",
        "order": 3,
        "frequencies": [0.5, 32],
        "unit": "Hz",
        "method": "sosfiltfilt (zero-phase)"
      },
      "notes": "Main EEG channel, captures frontal brain activity. Mean is negative due to DC offset (removed by high-pass filter)."
    },
    "EEG_Pz_Oz": {
      "description": "EEG parietal-occipital (Pz-Oz)",
      "unit": "μV",
      "sampling_rate": 100,
      "mean": -59.59,
      "std": 440.34,
      "min": -4507.05,
      "max": 4526.46,
      "typical_range_p1": -2353.23,
      "typical_range_p99": 360.19,
      "median": -0.18,
      "physical_range": [-3000, 3000],
      "digital_range": [-8192, 8191],
      "filter": {
        "type": "Butterworth bandpass",
        "order": 3,
        "frequencies": [0.5, 32],
        "unit": "Hz",
        "method": "sosfiltfilt (zero-phase)"
      },
      "notes": "Posterior EEG channel, captures occipital brain activity. Higher variance than Fpz-Cz. Mean is negative due to DC offset."
    },
    "EOG_horizontal": {
      "description": "Electrooculogram horizontal (eye movement)",
      "unit": "μV",
      "sampling_rate": 100,
      "mean": -59.69,
      "std": 352.37,
      "min": -2921.99,
      "max": 2906.61,
      "typical_range_p1": -2353.23,
      "typical_range_p99": 275.22,
      "median": -0.18,
      "physical_range": [-3000, 3000],
      "digital_range": [-8192, 8191],
      "filter": {
        "type": "Butterworth bandpass",
        "order": 3,
        "frequencies": [0.5, 10],
        "unit": "Hz",
        "method": "sosfiltfilt (zero-phase)"
      },
      "notes": "Eye movement channel. Lower frequency cutoff (10 Hz vs 32 Hz) because eye movements are slower. Essential for detecting REM sleep."
    }
  },
  
  "processing_pipeline": {
    "step_1_filtering": {
      "description": "Apply Butterworth bandpass filters",
      "eeg_channels": ["EEG_Fpz_Cz", "EEG_Pz_Oz"],
      "eeg_filter": [0.5, 32],
      "eog_channel": "EOG_horizontal",
      "eog_filter": [0.5, 10],
      "effect": "Removes DC offset, high-frequency noise, and 50/60 Hz artifacts"
    },
    "step_2_segmentation": {
      "description": "Segment into 30-second epochs",
      "epoch_duration_seconds": 30,
      "samples_per_epoch": 3000,
      "output_shape": "(n_epochs, 3_channels, 3000_samples)"
    },
    "step_3_windowing": {
      "description": "Create sliding windows of consecutive epochs",
      "window_epochs": 10,
      "window_duration_seconds": 300,
      "window_duration_minutes": 5,
      "samples_per_window": 30000,
      "output_shape": "(n_windows, 10_epochs, 3_channels * 3000_samples)",
      "output_shape_flat": "(n_windows, 10, 9000)"
    },
    "step_4_normalization": {
      "description": "Per-channel normalization using StandardScaler",
      "method": "sklearn.preprocessing.StandardScaler",
      "fit_on": "training_data_only",
      "transform_on": "train_val_test",
      "normalization_unit": "per_channel_on_flattened_windows",
      "notes": "Normalization is applied after windowing, on flattened windows"
    }
  },
  
  "model_input": {
    "shape": "(batch_size, 10, 9000)",
    "dtype": "float32",
    "description": "10 epochs (30s each) = 5 minutes of data, flattened 3 channels * 3000 samples"
  },
  
  "sleep_stages": {
    "classes": {
      "0": {"name": "Wake", "label": "W"},
      "1": {"name": "Stage 1", "label": "N1"},
      "2": {"name": "Stage 2", "label": "N2"},
      "3": {"name": "Stage 3/4 (Deep Sleep)", "label": "N3"},
      "4": {"name": "REM", "label": "R"}
    },
    "epoch_duration": 30,
    "label_format": "per_epoch"
  },
  
  "data_characteristics": {
    "dc_offset": {
      "present": true,
      "mean_value": -59.7,
      "removed_by": "high_pass_filter",
      "note": "Mean is negative but median is near zero (~-0.18), indicating DC offset that doesn't affect distribution"
    },
    "variance": {
      "high": true,
      "reason": "Amplitude changes between sleep stages, movement artifacts, eye movements",
      "typical_std": "346-440 μV"
    },
    "typical_values": {
      "explanation": "1-99 percentile range is much narrower than absolute range",
      "lower_bound": -2353.23,
      "upper_bound": "121-360 μV (channel dependent)",
      "note": "Most values fall within this range, outliers are artifacts"
    }
  },
  
  "implementation_notes": {
    "data_generation": {
      "method": "Generate in μV units directly (not ADC counts)",
      "distribution": "Normal distribution with mean ~-60 μV and std 346-440 μV",
      "filtering": "Apply Butterworth bandpass filters after generation",
      "clipping": "Clip to physical range [-3000, 3000] μV",
      "offset": "Consider generating with mean=0 and adding DC offset, or using mean=-60 directly"
    },
    "artifacts": {
      "movement": "Occasional bursts of high amplitude",
      "eye_movement": "EOG channel shows rapid changes during REM",
      "sleep_stages": "Amplitude varies: Deep sleep (N3) has high amplitude low frequency, REM has rapid eye movements"
    },
    "correlation": {
      "eeg_channels": "EEG Fpz-Cz and EEG Pz-Oz are correlated (both brain activity)",
      "eog": "EOG has lower correlation with EEG, shows eye movements independently"
    }
  },
  
  "validation": {
    "method": "Generate 100 epochs (50 minutes) and compare statistics",
    "tolerance": {
      "mean": "< 10% difference",
      "std": "< 20% difference",
      "range": "Within typical_range_p1 to typical_range_p99"
    },
    "checks": [
      "Mean should be around -60 μV (or near 0 if DC offset removed)",
      "Std should be 346-440 μV depending on channel",
      "Values should fall within physical range [-3000, 3000] μV",
      "Typical values (1-99%) should match dataset range"
    ]
  }
}

